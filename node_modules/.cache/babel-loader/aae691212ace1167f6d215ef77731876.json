{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _parseInt from \"@babel/runtime-corejs2/core-js/parse-int\";\nimport _Promise from \"@babel/runtime-corejs2/core-js/promise\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport React, { Component } from 'react';\nimport Layout from '../../../components/Layout';\nimport { Button, Table } from 'semantic-ui-react';\nimport { Link } from '../../../routes';\nimport Campaign from '../../../ethereum/campaign';\nimport RequestRow from '../../../components/RequestRow';\n\nvar RequestIndex =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(RequestIndex, _Component);\n\n  function RequestIndex() {\n    _classCallCheck(this, RequestIndex);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(RequestIndex).apply(this, arguments));\n  }\n\n  _createClass(RequestIndex, [{\n    key: \"renderRows\",\n    value: function renderRows() {\n      var _this = this;\n\n      return this.props.requests.map(function (request, index) {\n        return React.createElement(RequestRow, {\n          key: index,\n          id: index,\n          request: request,\n          address: _this.props.address,\n          approversCount: _this.props.approversCount\n        });\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var Header = Table.Header,\n          Row = Table.Row,\n          HeaderCell = Table.HeaderCell,\n          Body = Table.Body;\n      return React.createElement(Layout, null, React.createElement(\"h3\", null, \"Request List\"), React.createElement(Link, {\n        route: \"/campaigns/\".concat(this.props.address, \"/requests/new\")\n      }, React.createElement(\"a\", null, React.createElement(Button, {\n        primary: true,\n        floated: \"right\",\n        style: {\n          marginBottom: 10\n        }\n      }, \"Add request\"))), React.createElement(Table, null, React.createElement(Header, null, React.createElement(Row, null, React.createElement(HeaderCell, null, \"Id\"), React.createElement(HeaderCell, null, \"Description\"), React.createElement(HeaderCell, null, \"Amount\"), React.createElement(HeaderCell, null, \"Recipient\"), React.createElement(HeaderCell, null, \"Approval Count\"), React.createElement(HeaderCell, null, \"Approve\"), React.createElement(HeaderCell, null, \"Finalize\"))), React.createElement(Body, null, this.renderRows())), React.createElement(\"div\", null, \"Found \", this.props.requestCount, \" request.\"));\n    }\n  }], [{\n    key: \"getInitialProps\",\n    value: function () {\n      var _getInitialProps = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(props) {\n        var address, campaign, requestCount, approversCount, requests;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                address = props.query.address;\n                campaign = Campaign(address);\n                _context.next = 4;\n                return campaign.methods.getRequestCount().call();\n\n              case 4:\n                requestCount = _context.sent;\n                _context.next = 7;\n                return campaign.methods.approversCount().call();\n\n              case 7:\n                approversCount = _context.sent;\n                _context.next = 10;\n                return _Promise.all(Array(_parseInt(requestCount)).fill().map(function (element, index) {\n                  return campaign.methods.requests(index).call();\n                }));\n\n              case 10:\n                requests = _context.sent;\n                console.log(requests);\n                return _context.abrupt(\"return\", {\n                  address: address,\n                  requests: requests,\n                  requestCount: requestCount,\n                  approversCount: approversCount\n                });\n\n              case 13:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      function getInitialProps(_x) {\n        return _getInitialProps.apply(this, arguments);\n      }\n\n      return getInitialProps;\n    }()\n  }]);\n\n  return RequestIndex;\n}(Component);\n\nexport default RequestIndex;","map":{"version":3,"sources":["/home/irving/Documents/ethereum/fuentes/blockchainCampaign/pages/campaigns/requests/index.js"],"names":["React","Component","Layout","Button","Table","Link","Campaign","RequestRow","RequestIndex","props","requests","map","request","index","address","approversCount","Header","Row","HeaderCell","Body","marginBottom","renderRows","requestCount","query","campaign","methods","getRequestCount","call","all","Array","fill","element","console","log"],"mappings":";;;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAOC,MAAP,MAAmB,4BAAnB;AACA,SAASC,MAAT,EAAiBC,KAAjB,QAA8B,mBAA9B;AACA,SAASC,IAAT,QAAqB,iBAArB;AACA,OAAOC,QAAP,MAAqB,4BAArB;AACA,OAAOC,UAAP,MAAuB,gCAAvB;;IAEMC,Y;;;;;;;;;;;;;iCAmBS;AAAA;;AACX,aAAO,KAAKC,KAAL,CAAWC,QAAX,CAAoBC,GAApB,CAAwB,UAACC,OAAD,EAAUC,KAAV,EAAoB;AACjD,eAAO,oBAAC,UAAD;AACL,UAAA,GAAG,EAAEA,KADA;AAEL,UAAA,EAAE,EAAEA,KAFC;AAGL,UAAA,OAAO,EAAED,OAHJ;AAIL,UAAA,OAAO,EAAE,KAAI,CAACH,KAAL,CAAWK,OAJf;AAKL,UAAA,cAAc,EAAE,KAAI,CAACL,KAAL,CAAWM;AALtB,UAAP;AAOD,OARM,CAAP;AASD;;;6BAEO;AAAA,UACEC,MADF,GACoCZ,KADpC,CACEY,MADF;AAAA,UACUC,GADV,GACoCb,KADpC,CACUa,GADV;AAAA,UACeC,UADf,GACoCd,KADpC,CACec,UADf;AAAA,UAC2BC,IAD3B,GACoCf,KADpC,CAC2Be,IAD3B;AAEN,aACE,oBAAC,MAAD,QACE,+CADF,EAEE,oBAAC,IAAD;AAAM,QAAA,KAAK,uBAAgB,KAAKV,KAAL,CAAWK,OAA3B;AAAX,SACE,+BACE,oBAAC,MAAD;AAAQ,QAAA,OAAO,MAAf;AAAgB,QAAA,OAAO,EAAC,OAAxB;AAAgC,QAAA,KAAK,EAAE;AAACM,UAAAA,YAAY,EAAE;AAAf;AAAvC,uBADF,CADF,CAFF,EAOE,oBAAC,KAAD,QACE,oBAAC,MAAD,QACE,oBAAC,GAAD,QACE,oBAAC,UAAD,aADF,EAEE,oBAAC,UAAD,sBAFF,EAGE,oBAAC,UAAD,iBAHF,EAIE,oBAAC,UAAD,oBAJF,EAKE,oBAAC,UAAD,yBALF,EAME,oBAAC,UAAD,kBANF,EAOE,oBAAC,UAAD,mBAPF,CADF,CADF,EAYE,oBAAC,IAAD,QACG,KAAKC,UAAL,EADH,CAZF,CAPF,EAuBE,2CAAY,KAAKZ,KAAL,CAAWa,YAAvB,cAvBF,CADF;AA2BD;;;;;;gDA1D4Bb,K;;;;;;AACnBK,gBAAAA,O,GAAYL,KAAK,CAACc,K,CAAlBT,O;AACFU,gBAAAA,Q,GAAWlB,QAAQ,CAACQ,OAAD,C;;uBACEU,QAAQ,CAACC,OAAT,CAAiBC,eAAjB,GAAmCC,IAAnC,E;;;AAArBL,gBAAAA,Y;;uBACuBE,QAAQ,CAACC,OAAT,CAAiBV,cAAjB,GAAkCY,IAAlC,E;;;AAAvBZ,gBAAAA,c;;uBAEiB,SAAQa,GAAR,CACrBC,KAAK,CAAC,UAASP,YAAT,CAAD,CAAL,CACCQ,IADD,GAECnB,GAFD,CAEK,UAACoB,OAAD,EAAUlB,KAAV,EAAoB;AACvB,yBAAOW,QAAQ,CAACC,OAAT,CAAiBf,QAAjB,CAA0BG,KAA1B,EAAiCc,IAAjC,EAAP;AACD,iBAJD,CADqB,C;;;AAAjBjB,gBAAAA,Q;AAONsB,gBAAAA,OAAO,CAACC,GAAR,CAAYvB,QAAZ;iDACO;AAAEI,kBAAAA,OAAO,EAAPA,OAAF;AAAWJ,kBAAAA,QAAQ,EAARA,QAAX;AAAqBY,kBAAAA,YAAY,EAAZA,YAArB;AAAmCP,kBAAAA,cAAc,EAAdA;AAAnC,iB;;;;;;;;;;;;;;;;;;;EAhBgBd,S;;AAgE3B,eAAeO,YAAf","sourcesContent":["import React, { Component } from 'react';\nimport Layout from '../../../components/Layout';\nimport { Button, Table } from 'semantic-ui-react';\nimport { Link } from '../../../routes';\nimport Campaign from '../../../ethereum/campaign';\nimport RequestRow from '../../../components/RequestRow';\n\nclass RequestIndex extends Component{\n\n  static async getInitialProps(props){\n    const { address } = props.query;\n    const campaign = Campaign(address);\n    const requestCount = await campaign.methods.getRequestCount().call();\n    const approversCount = await campaign.methods.approversCount().call();\n\n    const requests = await Promise.all(\n      Array(parseInt(requestCount))\n      .fill()\n      .map((element, index) => {\n        return campaign.methods.requests(index).call();\n      })\n    );\n    console.log(requests);\n    return { address, requests, requestCount, approversCount };\n  }\n\n  renderRows() {\n    return this.props.requests.map((request, index) => {\n      return <RequestRow\n        key={index}\n        id={index}\n        request={request}\n        address={this.props.address}\n        approversCount={this.props.approversCount}\n      />\n    });\n  }\n\n  render(){\n    const { Header, Row, HeaderCell, Body } = Table;\n    return(\n      <Layout>\n        <h3>Request List</h3>\n        <Link route={`/campaigns/${this.props.address}/requests/new`}>\n          <a>\n            <Button primary floated='right' style={{marginBottom: 10}}>Add request</Button>\n          </a>\n        </Link>\n        <Table>\n          <Header>\n            <Row>\n              <HeaderCell>Id</HeaderCell>\n              <HeaderCell>Description</HeaderCell>\n              <HeaderCell>Amount</HeaderCell>\n              <HeaderCell>Recipient</HeaderCell>\n              <HeaderCell>Approval Count</HeaderCell>\n              <HeaderCell>Approve</HeaderCell>\n              <HeaderCell>Finalize</HeaderCell>\n            </Row>\n          </Header>\n          <Body>\n            {this.renderRows()}\n          </Body>\n        </Table>\n        <div>Found {this.props.requestCount} request.</div>\n      </Layout>\n    );\n  }\n\n}\n\nexport default RequestIndex;\n"]},"metadata":{},"sourceType":"module"}